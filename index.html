<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alumni Registration</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { max-width: 500px; margin: auto; }
        label { display: block; margin-top: 10px; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; }
        canvas { border: 1px solid black; margin-top: 10px; cursor: crosshair; }
        button { margin-top: 10px; padding: 10px; }
    </style>
</head>
<body>
    <h2>Alumni Registration Form</h2>
    <form id="alumniForm">
        <label>First Name:</label>
        <input type="text" id="firstName" name="firstName" required>
    
        <label>Last Name:</label>
        <input type="text" id="lastName" name="lastName" required>
    
        <label>Middle Name:</label>
        <input type="text" id="middleName" name="middleName">
    
        <label>Department:</label>
        <select id="department" name="department" required onchange="showAdditionalFields()">
            <option value="">Select Department</option>
            <option value="JHS">JHS</option>
            <option value="SHS">SHS</option>
            <option value="College">College</option>
            <option value="TED">TED</option>
        </select>
    
        <div id="additionalFields"></div>
    
        <label>Batch:</label>
        <select id="batch" name="batch" required></select>
    
        <label>Section:</label>
        <input type="text" id="section" name="section" required>
    
        <label>Class Number:</label>
        <input type="text" id="classNumber" name="classNumber" required>
    
        <label>Address:</label>
        <input type="text" id="address" name="address" required>
    
        <label>Birthdate:</label>
        <input type="date" id="birthdate" name="birthdate" required>
    
        <label>Phone No.:</label>
        <input type="tel" id="phone" name="phone" pattern="\d{11}" maxlength="11" required>
    
        <label>Email:</label>
        <input type="email" id="email" name="email" required>
    
        <label>Emergency Contact Person:</label>
        <input type="text" id="emergencyContact" name="emergencyContact" required>
    
        <label>Emergency Contact's Number:</label>
        <input type="tel" id="emergencyPhone" name="emergencyPhone" pattern="\d{11}" maxlength="11" required>
    
        <label>Emergency Contact's Address:</label>
        <input type="text" id="emergencyAddress" name="emergencyAddress" required>
    
        <label>Signature:</label>
        <canvas id="signatureCanvas" width="400" height="150"></canvas>
        <button type="button" onclick="clearCanvas()">Clear Signature</button>
    
        <button type="submit">Submit</button>
    </form>

    <script>
  document.addEventListener("DOMContentLoaded", function () {
    let batchSelect = document.getElementById("batch");
    for (let year = 1991; year <= 2030; year++) {
        let option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        batchSelect.appendChild(option);
    }

    document.getElementById("alumniForm").addEventListener("submit", function (event) {
        event.preventDefault();

        // Get strand/course dynamically
        let additionalSelection = document.querySelector("select[name='strandOrCourse']")?.value || "";

        let formData = {
            firstName: document.getElementById("firstName").value,
            lastName: document.getElementById("lastName").value,
            middleName: document.getElementById("middleName").value,
            department: document.getElementById("department").value,
            strand: document.getElementById("department").value === "SHS" ? additionalSelection : "",
            course: document.getElementById("department").value === "College" ? additionalSelection : "",
            batch: document.getElementById("batch").value,
            section: document.getElementById("section").value,
            classNumber: document.getElementById("classNumber").value,
            address: document.getElementById("address").value,
            birthdate: document.getElementById("birthdate").value,
            phone: document.getElementById("phone").value,
            email: document.getElementById("email").value,
            emergencyContact: document.getElementById("emergencyContact").value,
            emergencyPhone: document.getElementById("emergencyPhone").value,
            emergencyAddress: document.getElementById("emergencyAddress").value,
            signature: getSignature()
        };

        fetch("https://script.google.com/macros/s/AKfycbx7D4_huCk3y199cr_8A1I0RRa22RNndToju2PBw4Ay5Kh8xGIoH2bIydzbQG-0wQsXmA/exec", {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(formData)
        }).then(() => {
            alert("Form submitted successfully!");
            document.getElementById("alumniForm").reset();
            clearCanvas();
        }).catch(error => console.error("Error:", error));
    });
});

function showAdditionalFields() {
    let department = document.getElementById("department").value;
    let additionalFields = document.getElementById("additionalFields");
    additionalFields.innerHTML = "";

    if (department === "SHS") {
        additionalFields.innerHTML = `
            <label>Strand:</label>
            <select name="strandOrCourse" required>
                <option value="ABM">ABM</option>
                <option value="STEM">STEM</option>
                <option value="GA-HUMSS">GA-HUMSS</option>
            </select>
        `;
    } else if (department === "College") {
        additionalFields.innerHTML = `
            <label>Course:</label>
            <select name="strandOrCourse" required>
                <option value="BS Accountancy">Bachelor of Science in Accountancy</option>
                <option value="BSBA Marketing">Bachelor of Science in Business Administration Major in Marketing Management</option>
                <option value="BS Hospitality Management">Bachelor of Science in Hospitality Management</option>
                <option value="BS Tourism Management">Bachelor of Science in Tourism Management</option>
                <option value="BS Information Technology">Bachelor of Science in Information Technology</option>
                <option value="BS Electronics Engineering">Bachelor of Science in Electronics Engineering</option>
                <option value="BS Industrial Tech Auto">Bachelor of Science in Industrial Technology Major in Automotive Technology</option>
                <option value="BS Industrial Tech Mech">Bachelor of Science in Industrial Technology Major in Mechanical Technology</option>
                <option value="BSE English">Bachelor of Secondary Education Major in English</option>
                <option value="BEEd">Bachelor of Elementary Education</option>
            </select>
        `;
    }
}

// Function to retrieve the signature as a base64 image
function getSignature() {
    let canvas = document.getElementById("signatureCanvas");
    return canvas.toDataURL("image/png"); // Convert canvas to base64 image
}

// Function to clear the canvas
function clearCanvas() {
    let canvas = document.getElementById("signatureCanvas");
    let ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}

        // Function to retrieve the signature as a base64 image
        function getSignature() {
    let canvas = document.getElementById("signatureCanvas");
    let base64Image = canvas.toDataURL("image/png");
    return base64Image.replace(/^data:image\/png;base64,/, "");
        }

        // Function to clear the canvas
        function clearCanvas() {
            let canvas = document.getElementById("signatureCanvas");
            let ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Enable drawing on the canvas
        document.addEventListener("DOMContentLoaded", function () {
            let canvas = document.getElementById("signatureCanvas");
            let ctx = canvas.getContext("2d");
            let drawing = false;

            canvas.addEventListener("mousedown", () => { drawing = true; });
            canvas.addEventListener("mouseup", () => { drawing = false; ctx.beginPath(); });
            canvas.addEventListener("mousemove", draw);

            function draw(event) {
                if (!drawing) return;
                ctx.lineWidth = 2;
                ctx.lineCap = "round";
                ctx.strokeStyle = "black";

                ctx.lineTo(event.offsetX, event.offsetY);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(event.offsetX, event.offsetY);
            }
        });
    </script>
</body>
</html>
